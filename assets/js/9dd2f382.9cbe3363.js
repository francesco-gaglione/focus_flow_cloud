"use strict";(globalThis.webpackChunkdoc=globalThis.webpackChunkdoc||[]).push([[349],{5105(e,n,r){r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"architecture/backend","title":"Backend Architecture","description":"FocusFlow\'s backend is built using Clean Architecture principles to ensure separation of concerns, testability, and independence from external frameworks.","source":"@site/docs/architecture/backend.md","sourceDirName":"architecture","slug":"/architecture/backend","permalink":"/focus_flow_cloud/docs/architecture/backend","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Architecture Overview","permalink":"/focus_flow_cloud/docs/architecture/overview"},"next":{"title":"App Architecture","permalink":"/focus_flow_cloud/docs/architecture/app"}}');var i=r(4848),t=r(8453);const c={sidebar_position:2},a="Backend Architecture",o={},l=[{value:"\ud83c\udfd7\ufe0f High-Level Overview",id:"\ufe0f-high-level-overview",level:2},{value:"\ud83d\udce6 Workspace Structure",id:"-workspace-structure",level:2},{value:"1. <code>crates/domain</code> (The Core)",id:"1-cratesdomain-the-core",level:3},{value:"2. <code>crates/application</code> (The Orchestration)",id:"2-cratesapplication-the-orchestration",level:3},{value:"3. <code>crates/adapters</code> (The Interface)",id:"3-cratesadapters-the-interface",level:3},{value:"4. <code>crates/infrastructure</code> (The Plumbing)",id:"4-cratesinfrastructure-the-plumbing",level:3},{value:"Swagger",id:"swagger",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"backend-architecture",children:"Backend Architecture"})}),"\n",(0,i.jsxs)(n.p,{children:["FocusFlow's backend is built using ",(0,i.jsx)(n.strong,{children:"Clean Architecture"})," principles to ensure separation of concerns, testability, and independence from external frameworks."]}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-high-level-overview",children:"\ud83c\udfd7\ufe0f High-Level Overview"}),"\n",(0,i.jsxs)(n.p,{children:["The system is organized into four concentric layers, with dependencies flowing ",(0,i.jsx)(n.strong,{children:"inwards"}),". The inner layers know nothing about the outer layers."]}),"\n",(0,i.jsx)(n.mermaid,{value:'graph TD\n    %%{init: {\n      \'theme\': \'base\',\n      \'themeVariables\': {\n        \'fontSize\': \'20px\',\n        \'fontFamily\': \'arial\',\n        \'background\': \'#ffffff\',\n        \'primaryColor\': \'#ffffff\',\n        \'mainBkg\': \'#ffffff\',\n        \'clusterBkg\': \'#f5f5f5\',\n        \'clusterBorder\': \'#333333\',\n        \'lineColor\': \'#000000\',\n        \'primaryTextColor\': \'#000000\'\n      }\n    }}%%\n\n    subgraph External["External World"]\n        UI["User Interface / Client"]\n        DB[("PostgreSQL Database")]\n    end\n\n    subgraph Infrastructure["Infrastructure Layer (crates/infrastructure)"]\n        Setup["Setup (setup.rs)"]\n        Migrations["Migrations (database/)"]\n        Crypto["Crypto (crypto/)"]\n        Services["Services (services/)"]\n    end\n\n    subgraph Adapters["Interface Adapters (crates/adapters)"]\n        App["App Entry (app.rs)"]\n        OpenApi["OpenAPI (openapi.rs)"]\n        Http["HTTP Controllers (http/)"]\n        Persistence["Persistence (persistence/)"]\n        Mappers["Mappers (mappers/)"]\n        Middleware["Middleware (middleware/)"]\n    end\n\n    subgraph Application["Application Layer (crates/application)"]\n        UseCases["Use Cases (use_cases/)"]\n        ConfigApp["Config (config.rs)"]\n    end\n\n    subgraph Domain["Domain Layer (crates/domain)"]\n        Entities["Entities (entities/)"]\n        Traits["Traits (traits/)"]\n        DomainServices["Domain Services (services/)"]\n        Errors["Errors (error/)"]\n    end\n\n    %% Dependency Flow (Inwards)\n    External --\x3e Infrastructure\n    Infrastructure --\x3e Adapters\n    Adapters --\x3e Application\n    Application --\x3e Domain\n\n    %% Specific connections matches dependency direction\n    Setup --\x3e App\n    Setup --\x3e Migrations\n    App --\x3e Http\n    App --\x3e OpenApi\n    App --\x3e Middleware\n    Http --\x3e UseCases\n    Http --\x3e Mappers\n    UseCases --\x3e Entities\n    UseCases --\x3e Traits\n    Persistence -.->Traits\n    Services -.-> Traits'}),"\n",(0,i.jsx)(n.h2,{id:"-workspace-structure",children:"\ud83d\udce6 Workspace Structure"}),"\n",(0,i.jsx)(n.p,{children:"The backend is a Rust workspace organized into four main crates, strictly following the Clean Architecture dependency rule:"}),"\n",(0,i.jsxs)(n.h3,{id:"1-cratesdomain-the-core",children:["1. ",(0,i.jsx)(n.code,{children:"crates/domain"})," (The Core)"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Responsibility"}),": Contains the enterprise business rules and pure logic. It is stable and independent of frameworks."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dependencies"}),": None."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Contents"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Entities"}),": Mutable business objects (e.g., ",(0,i.jsx)(n.code,{children:"FocusSession"}),", ",(0,i.jsx)(n.code,{children:"Task"}),", ",(0,i.jsx)(n.code,{children:"User"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Traits"}),": Interfaces (Ports) for repositories and services (defined here, implemented outer)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services"}),": Domain services for logic that doesn't fit into a single entity."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Errors"}),": Domain-specific error definitions."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"2-cratesapplication-the-orchestration",children:["2. ",(0,i.jsx)(n.code,{children:"crates/application"})," (The Orchestration)"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Responsibility"}),': Application-specific business rules. It implements the "Use Cases" of the system.']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dependencies"}),": ",(0,i.jsx)(n.code,{children:"domain"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Contents"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use Cases"}),": Interactors that orchestrate the flow of data using domain entities and repository traits (e.g., ",(0,i.jsx)(n.code,{children:"StartSession"}),", ",(0,i.jsx)(n.code,{children:"CreateTask"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Config"}),": Application configuration logic."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"3-cratesadapters-the-interface",children:["3. ",(0,i.jsx)(n.code,{children:"crates/adapters"})," (The Interface)"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Responsibility"}),": Converts data between the format most convenient for use cases/entities and the format convenient for external agencies (Web, DB)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dependencies"}),": ",(0,i.jsx)(n.code,{children:"application"}),", ",(0,i.jsx)(n.code,{children:"domain"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Contents"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"App Entry"}),": ",(0,i.jsx)(n.code,{children:"app.rs"})," initializes the application wiring."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Http"}),": Controllers/Handlers for the REST API."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"OpenAPI"}),": API documentation definitions (",(0,i.jsx)(n.code,{children:"openapi.rs"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Persistence"}),": Concrete implementation of repository traits (adapting to Diesel/SQL)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Mappers"}),": Translation between DTOs and Domain Entities."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Middleware"}),": Authentication and other cross-cutting concerns."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"4-cratesinfrastructure-the-plumbing",children:["4. ",(0,i.jsx)(n.code,{children:"crates/infrastructure"})," (The Plumbing)"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Responsibility"}),": Contains details about frameworks, drivers, and external tools. The outermost layer."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dependencies"}),": ",(0,i.jsx)(n.code,{children:"adapters"}),", ",(0,i.jsx)(n.code,{children:"application"}),", ",(0,i.jsx)(n.code,{children:"domain"})," (for setup and wiring)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Contents"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Setup"}),": ",(0,i.jsx)(n.code,{children:"setup.rs"})," bootstraps the database pool and other infrastructure."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Database"}),": Database migrations and connection logic."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services"}),": Implementations of external services (e.g., Crypto, Third-party APIs)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"swagger",children:"Swagger"}),"\n",(0,i.jsxs)(n.p,{children:["API documentation for the backend is available at ",(0,i.jsx)(n.code,{children:"/swagger-ui"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>c,x:()=>a});var s=r(6540);const i={},t=s.createContext(i);function c(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);