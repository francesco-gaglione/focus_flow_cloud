{"openapi":"3.1.0","info":{"title":"Focus flow app API","description":"","license":{"name":""},"version":"0.1.0"},"servers":[{"url":"/","description":"API server"}],"paths":{"/api/auth/login":{"post":{"tags":["Auth"],"summary":"Login user","operationId":"login_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}},"required":true},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized - Invalid credentials"},"500":{"description":"Internal server error"}}}},"/api/auth/logout":{"post":{"tags":["Auth"],"summary":"Logout user","operationId":"logout_api","responses":{"200":{"description":"Logout successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogoutResponseDto"}}}},"500":{"description":"Internal server error"}}}},"/api/auth/refresh":{"post":{"tags":["Auth"],"summary":"Refresh access token","operationId":"refresh_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshDto"}}},"required":true},"responses":{"200":{"description":"Refresh successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized - Invalid refresh token"},"500":{"description":"Internal server error"}}}},"/api/category":{"get":{"tags":["Category"],"summary":"Get all categories and their tasks","operationId":"get_categories_and_tasks_api","responses":{"200":{"description":"Category list","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetCategoriesResponseDto"}}}},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]},"post":{"tags":["Category"],"summary":"Create a new category","operationId":"create_category_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCategoryDto"}}},"required":true},"responses":{"200":{"description":"Category created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCategoryResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"409":{"description":"Category already exists"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/category/{id}":{"get":{"tags":["Category"],"summary":"Get a category by id","operationId":"get_category","parameters":[{"name":"id","in":"path","description":"Category ID","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Category","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetCategoryResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Category not found"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]},"put":{"tags":["Category"],"summary":"Update a category","operationId":"update_category_api","parameters":[{"name":"id","in":"path","description":"Category ID to update","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateCategoryDto"}}},"required":true},"responses":{"200":{"description":"Category updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateCategoryResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"404":{"description":"Category not found"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]},"delete":{"tags":["Category"],"summary":"Delete a category by id","description":"Delete a category and all its tasks by id","operationId":"delete_categories_api","parameters":[{"name":"id","in":"path","description":"Category ID to delete","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Category deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteCategoriesResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/focus-sessions":{"get":{"tags":["Session"],"summary":"Get focus sessions by filters","operationId":"get_sessions","parameters":[{"name":"startDate","in":"query","required":false,"schema":{"type":["integer","null"],"format":"int64"}},{"name":"endDate","in":"query","required":false,"schema":{"type":["integer","null"],"format":"int64"}},{"name":"categoryIds","in":"query","required":false,"schema":{"type":["array","null"],"items":{"type":"string"}}},{"name":"sessionType","in":"query","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/SessionTypeEnum"}]}},{"name":"minConcentrationScore","in":"query","required":false,"schema":{"type":["integer","null"],"format":"int32"}},{"name":"maxConcentrationScore","in":"query","required":false,"schema":{"type":["integer","null"],"format":"int32"}},{"name":"hasNotes","in":"query","required":false,"schema":{"type":["boolean","null"]}}],"responses":{"200":{"description":"Sessions fetched successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetSessionFiltersResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/focus-sessions/manual":{"post":{"tags":["Session"],"summary":"Create a manual focus session","operationId":"create_manual_session_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateManualSessionDto"}}},"required":true},"responses":{"201":{"description":"Session created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateManualSessionResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"409":{"description":"Session already exists"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/focus-sessions/{id}":{"put":{"tags":["Session"],"summary":"Update focus session","operationId":"update_session_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateFocusSessionDto"}}},"required":true},"responses":{"204":{"description":"Session updated successfully"},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"409":{"description":"Session already exists"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/setting":{"get":{"tags":["User Settings"],"summary":"Fetch user settings","operationId":"get_settings_api","responses":{"200":{"description":"Settings fetched successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserSettingsResponseDto"}}}},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]},"patch":{"tags":["User Settings"],"summary":"Update a user setting","operationId":"update_setting_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserSettingDto"}}},"required":true},"responses":{"200":{"description":"User setting updated successfully"},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/stats/period":{"get":{"tags":["Statistics"],"summary":"Get stats by period","operationId":"calculate_stats_by_period_api","parameters":[{"name":"startDate","in":"query","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"endDate","in":"query","required":false,"schema":{"type":["integer","null"],"format":"int64"}}],"responses":{"200":{"description":"Stats fetched successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetStatsByPeriodResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/tasks":{"get":{"tags":["Task"],"summary":"Get all tasks","operationId":"get_tasks_api","responses":{"200":{"description":"Tasks fetched successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TasksResponseDto"}}}},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]},"post":{"tags":["Task"],"summary":"Create a new task","operationId":"create_task_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTaskDto"}}},"required":true},"responses":{"201":{"description":"Task created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTaskResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"409":{"description":"Task already exists"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]},"delete":{"tags":["Task"],"summary":"Delete one or more tasks","operationId":"delete_tasks_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteTasksDto"}}},"required":true},"responses":{"200":{"description":"Tasks deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteTasksResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/tasks/orphans":{"get":{"tags":["Task"],"summary":"Get all orphan tasks (tasks without a category)","operationId":"fetch_orphan_tasks_api","responses":{"200":{"description":"Orphan tasks fetched successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrphanTasksResponseDto"}}}},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/tasks/{id}":{"put":{"tags":["Task"],"summary":"Update a task","operationId":"update_task_api","parameters":[{"name":"id","in":"path","description":"Task ID to update","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateTaskDto"}}},"required":true},"responses":{"200":{"description":"Task updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateTaskResponseDto"}}}},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized"},"404":{"description":"Task not found"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/users":{"post":{"tags":["Users"],"summary":"Create a new user","operationId":"create_user_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserDto"}}},"required":true},"responses":{"200":{"description":"User created successfully"},"400":{"description":"Bad request - validation error"},"401":{"description":"Unauthorized - invalid credentials or not admin"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/users/me":{"get":{"tags":["Users"],"summary":"Get current user info","operationId":"get_user_info_api","responses":{"200":{"description":"User info retrieved","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserInfoResponseDto"}}}},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/users/password":{"put":{"tags":["Users"],"summary":"Update user password","operationId":"update_password_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdatePasswordDto"}}},"required":true},"responses":{"200":{"description":"Password updated successfully"},"400":{"description":"Bad request - validation error or invalid password"},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}},"/api/users/username":{"put":{"tags":["Users"],"summary":"Update user username","operationId":"update_username_api","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUsernameDto"}}},"required":true},"responses":{"200":{"description":"Username updated successfully"},"400":{"description":"Bad request - validation error or username already exists"},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}},"security":[{"jwt":[]}]}}},"components":{"schemas":{"CategoryDistributionDto":{"type":"object","required":["categoryName","categoryId","totalFocusTime","percentage"],"properties":{"categoryId":{"type":"string"},"categoryName":{"type":"string"},"percentage":{"type":"number","format":"float"},"totalFocusTime":{"type":"integer","format":"int64"}}},"CategoryDto":{"type":"object","required":["id","name","color","tasks"],"properties":{"color":{"type":"string"},"description":{"type":["string","null"]},"id":{"type":"string"},"name":{"type":"string"},"tasks":{"type":"array","items":{"$ref":"#/components/schemas/TaskDto"}}}},"ConcentrationPeriodDto":{"type":"string","enum":["MORNING","AFTERNOON"]},"CreateCategoryDto":{"type":"object","required":["name"],"properties":{"color":{"type":["string","null"]},"description":{"type":["string","null"]},"name":{"type":"string"}}},"CreateCategoryResponseDto":{"type":"object","required":["category_id"],"properties":{"category_id":{"type":"string"}}},"CreateManualSessionDto":{"type":"object","required":["sessionType","startedAt","endedAt"],"properties":{"categoryId":{"type":["string","null"]},"concentrationScore":{"type":["integer","null"],"format":"int32"},"endedAt":{"type":"integer","format":"int64"},"notes":{"type":["string","null"]},"sessionType":{"$ref":"#/components/schemas/SessionTypeEnum"},"startedAt":{"type":"integer","format":"int64"},"taskId":{"type":["string","null"]}}},"CreateManualSessionResponseDto":{"type":"object","required":["id"],"properties":{"id":{"type":"string"}}},"CreateTaskDto":{"type":"object","required":["name"],"properties":{"categoryId":{"type":["string","null"]},"description":{"type":["string","null"]},"name":{"type":"string"},"scheduledDate":{"type":["integer","null"],"format":"int64"}}},"CreateTaskResponseDto":{"type":"object","required":["id"],"properties":{"id":{"type":"string"}}},"CreateUserDto":{"type":"object","required":["username","password"],"properties":{"password":{"type":"string"},"username":{"type":"string"}}},"DailyActivityDistributionDto":{"type":"object","required":["categoryName","categoryId","totalFocusTime"],"properties":{"categoryId":{"type":"string"},"categoryName":{"type":"string"},"totalFocusTime":{"type":"integer","format":"int64"}}},"DailyActivityDto":{"type":"object","required":["date","categoryDistribution"],"properties":{"categoryDistribution":{"type":"array","items":{"$ref":"#/components/schemas/DailyActivityDistributionDto"}},"date":{"type":"integer","format":"int64"}}},"DeleteCategoriesDto":{"type":"object","required":["id"],"properties":{"id":{"type":"string"}}},"DeleteCategoriesResponseDto":{"type":"object","required":["deleted_ids"],"properties":{"deleted_ids":{"type":"array","items":{"type":"string"}}}},"DeleteTasksDto":{"type":"object","required":["taskIds"],"properties":{"taskIds":{"type":"array","items":{"type":"string"}}}},"DeleteTasksResponseDto":{"type":"object","required":["deleted_ids"],"properties":{"deleted_ids":{"type":"array","items":{"type":"string"}}}},"FocusSessionDto":{"type":"object","required":["id","sessionType","startedAt","createdAt"],"properties":{"actualDuration":{"type":["integer","null"],"format":"int64"},"categoryId":{"type":["string","null"]},"concentrationScore":{"type":["integer","null"],"format":"int32"},"createdAt":{"type":"integer","format":"int64"},"endedAt":{"type":["integer","null"],"format":"int64"},"id":{"type":"string"},"notes":{"type":["string","null"]},"sessionType":{"$ref":"#/components/schemas/SessionTypeEnum"},"startedAt":{"type":"integer","format":"int64"},"taskId":{"type":["string","null"]}}},"GetCategoriesResponseDto":{"type":"object","required":["categories"],"properties":{"categories":{"type":"array","items":{"$ref":"#/components/schemas/CategoryDto"}}}},"GetCategoryResponseDto":{"allOf":[{"$ref":"#/components/schemas/CategoryDto"}]},"GetSessionFiltersDto":{"type":"object","properties":{"categoryIds":{"type":["array","null"],"items":{"type":"string"}},"endDate":{"type":["integer","null"],"format":"int64"},"hasNotes":{"type":["boolean","null"]},"maxConcentrationScore":{"type":["integer","null"],"format":"int32","example":"5"},"minConcentrationScore":{"type":["integer","null"],"format":"int32","example":"1"},"sessionType":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/SessionTypeEnum"}]},"startDate":{"type":["integer","null"],"format":"int64"}}},"GetSessionFiltersResponseDto":{"type":"object","required":["focusSessions"],"properties":{"focusSessions":{"type":"array","items":{"$ref":"#/components/schemas/FocusSessionDto"}}}},"GetStatsByPeriodDto":{"type":"object","required":["startDate"],"properties":{"endDate":{"type":["integer","null"],"format":"int64"},"startDate":{"type":"integer","format":"int64"}}},"GetStatsByPeriodResponseDto":{"type":"object","required":["totalSessions","totalBreaks","totalFocusTime","totalBreakTime","mostConcentratedPeriod","lessConcentratedPeriod","concentrationDistribution","categoryDistribution","taskDistribution","dailyActivity"],"properties":{"categoryDistribution":{"type":"array","items":{"$ref":"#/components/schemas/CategoryDistributionDto"}},"concentrationDistribution":{"type":"array","items":{"type":"integer","format":"int32","minimum":0}},"dailyActivity":{"type":"array","items":{"$ref":"#/components/schemas/DailyActivityDto"}},"lessConcentratedPeriod":{"$ref":"#/components/schemas/ConcentrationPeriodDto"},"mostConcentratedPeriod":{"$ref":"#/components/schemas/ConcentrationPeriodDto"},"taskDistribution":{"type":"array","items":{"$ref":"#/components/schemas/TaskDistributionDto"}},"totalBreakTime":{"type":"integer","format":"int64"},"totalBreaks":{"type":"integer","minimum":0},"totalFocusTime":{"type":"integer","format":"int64"},"totalSessions":{"type":"integer","minimum":0}}},"LoginDto":{"type":"object","required":["username","password"],"properties":{"password":{"type":"string"},"username":{"type":"string"}}},"LoginResponseDto":{"type":"object","required":["token","refresh_token"],"properties":{"refresh_token":{"type":"string"},"token":{"type":"string"}}},"LogoutResponseDto":{"type":"object","required":["message"],"properties":{"message":{"type":"string"}}},"OrphanTasksResponseDto":{"type":"object","required":["orphanTasks"],"properties":{"orphanTasks":{"type":"array","items":{"$ref":"#/components/schemas/TaskDto"}}}},"RefreshDto":{"type":"object","required":["refresh_token"],"properties":{"refresh_token":{"type":"string"}}},"RefreshResponseDto":{"type":"object","required":["token","refresh_token"],"properties":{"refresh_token":{"type":"string"},"token":{"type":"string"}}},"SessionTypeEnum":{"type":"string","enum":["Work","ShortBreak","LongBreak"]},"TaskDistributionDto":{"type":"object","required":["taskName","totalFocusTime","percentage"],"properties":{"categoryId":{"type":["string","null"]},"categoryName":{"type":["string","null"]},"percentage":{"type":"number","format":"float"},"taskName":{"type":"string"},"totalFocusTime":{"type":"integer","format":"int64"}}},"TaskDto":{"type":"object","required":["id","name"],"properties":{"categoryId":{"type":["string","null"]},"completedAt":{"type":["integer","null"],"format":"int64"},"description":{"type":["string","null"]},"id":{"type":"string"},"name":{"type":"string"},"scheduledDate":{"type":["integer","null"],"format":"int64"}}},"TasksResponseDto":{"type":"object","required":["tasks"],"properties":{"tasks":{"type":"array","items":{"$ref":"#/components/schemas/TaskDto"}}}},"UpdateCategoryDto":{"type":"object","properties":{"color":{"type":["string","null"]},"description":{"type":["string","null"]},"name":{"type":["string","null"]}}},"UpdateCategoryResponseDto":{"type":"object","required":["updatedCategory"],"properties":{"updatedCategory":{"$ref":"#/components/schemas/CategoryDto"}}},"UpdateFocusSessionDto":{"type":"object","properties":{"categoryId":{"type":["string","null"]},"concentrationScore":{"type":["integer","null"],"format":"int32"},"endedAt":{"type":["integer","null"],"format":"int64"},"notes":{"type":["string","null"]},"startedAt":{"type":["integer","null"],"format":"int64"},"taskId":{"type":["string","null"]}}},"UpdateFocusSessionResponseDto":{"type":"object"},"UpdatePasswordDto":{"type":"object","required":["old_password","new_password"],"properties":{"new_password":{"type":"string"},"old_password":{"type":"string"}}},"UpdateTaskDto":{"type":"object","properties":{"categoryId":{"type":["string","null"]},"completedAt":{"type":["integer","null"],"format":"int64"},"description":{"type":["string","null"]},"name":{"type":["string","null"]},"scheduledDate":{"type":["integer","null"],"format":"int64"}}},"UpdateTaskResponseDto":{"type":"object","required":["updatedTask"],"properties":{"updatedTask":{"$ref":"#/components/schemas/TaskDto"}}},"UpdateUserSettingDto":{"type":"object","required":["key","value"],"properties":{"key":{"type":"string"},"value":{"type":"string"}}},"UpdateUsernameDto":{"type":"object","required":["new_username"],"properties":{"new_username":{"type":"string"}}},"UserInfoResponseDto":{"type":"object","required":["id","username","role"],"properties":{"id":{"type":"string","format":"uuid"},"role":{"type":"string"},"username":{"type":"string"}}},"UserSettingDto":{"type":"object","required":["key","value"],"properties":{"key":{"type":"string"},"value":{"type":"string"}}},"UserSettingsResponseDto":{"type":"object","required":["settings"],"properties":{"settings":{"type":"array","items":{"$ref":"#/components/schemas/UserSettingDto"}}}}},"securitySchemes":{"jwt":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}},"tags":[{"name":"Category","description":"Endpoints for managing categories and their tasks"},{"name":"Task","description":"Endpoints for managing tasks"},{"name":"Session","description":"Endpoints for managing focus sessions"},{"name":"Statistics","description":"Endpoints for retrieving statistics"},{"name":"User Settings","description":"Endpoints for managing user settings"},{"name":"Users","description":"Endpoints for managing user"},{"name":"Auth","description":"Endpoints for authentication"}]}
